import{_ as i,o as a,c as n,aj as l}from"./chunks/framework.DOH55jbA.js";const E=JSON.parse('{"title":"工作原理","description":"","frontmatter":{"title":"工作原理"},"headers":[],"relativePath":"implementation.md","filePath":"implementation.md","lastUpdated":1769352403000}'),t={name:"implementation.md"};function h(e,s,p,r,k,d){return a(),n("div",null,[...s[0]||(s[0]=[l(`<h1 id="工作原理" tabindex="-1">工作原理 <a class="header-anchor" href="#工作原理" aria-label="Permalink to “工作原理”">​</a></h1><p>本文档详细说明 NotebookLM2PPT 的技术实现细节和工作原理，适合技术人员参考。</p><h2 id="🛠️-核心工作流程" tabindex="-1">🛠️ 核心工作流程 <a class="header-anchor" href="#🛠️-核心工作流程" aria-label="Permalink to “🛠️ 核心工作流程”">​</a></h2><p>NotebookLM2PPT 通过模拟人工操作，实现了一套高效的 PDF 到 PPT 转换流程：</p><div class="language-mermaid"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph TD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    A[PDF 文件] --&gt; B[PDF 转 PNG 图片]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    B --&gt; C{是否启用去水印?}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    C -- 是 --&gt; D[智能去除 NotebookLM 水印]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    C -- 否 --&gt; E[保留原始图像]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    D --&gt; F[全屏显示图片]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    E --&gt; F</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    F --&gt; G[调用微软电脑管家智能圈选]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    G --&gt; H[自动点击&#39;转换为PPT&#39;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    H --&gt; I[从下载目录提取生成的 PPT]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    I --&gt; J{是否提供 MinerU JSON?}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    J -- 是 --&gt; K[MinerU 深度优化]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    J -- 否 --&gt; L[合并所有单页 PPT]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    K --&gt; L</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    L --&gt; M[生成最终 PowerPoint 文件]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    style K fill:#90EE90</span></span></code></pre></div><h2 id="📁-项目结构" tabindex="-1">📁 项目结构 <a class="header-anchor" href="#📁-项目结构" aria-label="Permalink to “📁 项目结构”">​</a></h2><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>NotebookLM2PPT/</span></span>
<span class="line"><span>├── main.py                          # 程序主入口</span></span>
<span class="line"><span>├── requirements.txt                 # 依赖清单</span></span>
<span class="line"><span>├── notebooklm2ppt/                  # 核心包</span></span>
<span class="line"><span>│   ├── __init__.py                  # 包初始化文件</span></span>
<span class="line"><span>│   ├── pdf2png.py                   # PDF 转 PNG 模块</span></span>
<span class="line"><span>│   ├── ppt_combiner.py              # PPT 合并模块</span></span>
<span class="line"><span>│   └── utils/                       # 工具模块</span></span>
<span class="line"><span>│       ├── __init__.py              # 包初始化文件</span></span>
<span class="line"><span>│       ├── screenshot_automation.py # 截图自动化模块</span></span>
<span class="line"><span>│       ├── image_viewer.py          # 图像查看器模块</span></span>
<span class="line"><span>│       ├── image_inpainter.py       # 图像修复模块</span></span>
<span class="line"><span>│       └── ppt_refiner.py           # MinerU 优化模块</span></span>
<span class="line"><span>├── examples/                        # 示例 PDF 存放处</span></span>
<span class="line"><span>└── workspace/                       # 运行时的临时文件与输出结果</span></span></code></pre></div><h2 id="🔧-核心模块详解" tabindex="-1">🔧 核心模块详解 <a class="header-anchor" href="#🔧-核心模块详解" aria-label="Permalink to “🔧 核心模块详解”">​</a></h2><h3 id="pdf-转-png-模块" tabindex="-1">PDF 转 PNG 模块 <a class="header-anchor" href="#pdf-转-png-模块" aria-label="Permalink to “PDF 转 PNG 模块”">​</a></h3><p><strong>文件</strong>: <code>notebooklm2ppt/pdf2png.py</code></p><ul><li><strong>功能</strong>: 将 PDF 文件转换为高分辨率 PNG 图片</li><li><strong>实现</strong>: 使用 <code>pdf2image</code> 库</li><li><strong>关键特性</strong>: <ul><li>支持自定义 DPI 参数（默认 200）</li><li>批量处理多页 PDF</li><li>自动创建输出目录</li></ul></li><li><strong>技术细节</strong>: <ul><li>利用 PDF 渲染引擎确保文本和图像的准确还原</li><li>支持设置不同的 DPI 值以平衡质量和速度</li><li>自动处理页面大小和方向</li></ul></li></ul><h3 id="图像修复模块" tabindex="-1">图像修复模块 <a class="header-anchor" href="#图像修复模块" aria-label="Permalink to “图像修复模块”">​</a></h3><p><strong>文件</strong>: <code>notebooklm2ppt/utils/image_inpainter.py</code></p><ul><li><strong>功能</strong>: 自动识别并去除 NotebookLM 水印</li><li><strong>实现</strong>: 多种图像修复算法</li><li><strong>关键特性</strong>: <ul><li>自动检测水印位置</li><li>支持 6 种不同的修复算法</li><li>保持图像质量的同时去除水印</li></ul></li><li><strong>技术细节</strong>: <ul><li>识别水印区域的边界像素</li><li>从边界向内逐步填充</li><li>使用适当的算法计算填充值</li></ul></li></ul><h3 id="截图自动化模块" tabindex="-1">截图自动化模块 <a class="header-anchor" href="#截图自动化模块" aria-label="Permalink to “截图自动化模块”">​</a></h3><p><strong>文件</strong>: <code>notebooklm2ppt/utils/screenshot_automation.py</code></p><ul><li><strong>功能</strong>: 模拟用户操作，实现自动化转换流程</li><li><strong>实现</strong>: 使用鼠标和键盘模拟库</li><li><strong>关键特性</strong>: <ul><li>模拟键盘快捷键（Ctrl + Shift + A）</li><li>自动定位并点击&quot;转换为PPT&quot;按钮</li><li>支持按钮位置校准</li></ul></li><li><strong>技术细节</strong>: <ul><li>智能识别按钮位置</li><li>记录按钮相对于屏幕底部的垂直偏移量</li><li>内置错误处理机制</li></ul></li></ul><h3 id="图像查看器模块" tabindex="-1">图像查看器模块 <a class="header-anchor" href="#图像查看器模块" aria-label="Permalink to “图像查看器模块”">​</a></h3><p><strong>文件</strong>: <code>notebooklm2ppt/utils/image_viewer.py</code></p><ul><li><strong>功能</strong>: 全屏显示转换后的图片</li><li><strong>实现</strong>: 使用 Tkinter</li><li><strong>关键特性</strong>: <ul><li>全屏显示图片</li><li>支持自定义显示比例</li><li>ESC 键全局支持</li></ul></li><li><strong>技术细节</strong>: <ul><li>自动适应屏幕尺寸</li><li>支持不同屏幕分辨率</li></ul></li></ul><h3 id="ppt-合并模块" tabindex="-1">PPT 合并模块 <a class="header-anchor" href="#ppt-合并模块" aria-label="Permalink to “PPT 合并模块”">​</a></h3><p><strong>文件</strong>: <code>notebooklm2ppt/ppt_combiner.py</code></p><ul><li><strong>功能</strong>: 将单页 PPT 合并为完整的演示文稿</li><li><strong>实现</strong>: 使用 PowerPoint 自动化 API</li><li><strong>关键特性</strong>: <ul><li>自动检测下载目录中的临时 PPT 文件</li><li>按顺序合并幻灯片</li><li>保持原始格式和布局</li></ul></li><li><strong>技术细节</strong>: <ul><li>监控下载目录，实时检测新生成的 PPT 文件</li><li>使用 PowerPoint 自动化 API 实现幻灯片合并</li></ul></li></ul><h3 id="mineru-优化模块" tabindex="-1">MinerU 优化模块 <a class="header-anchor" href="#mineru-优化模块" aria-label="Permalink to “MinerU 优化模块”">​</a></h3><p><strong>文件</strong>: <code>notebooklm2ppt/utils/ppt_refiner.py</code></p><ul><li><strong>功能</strong>: 利用 MinerU 解析结果对 PPT 进行深度优化</li><li><strong>实现</strong>: 解析 MinerU JSON 并应用优化算法</li><li><strong>关键特性</strong>: <ul><li>智能文本框筛选</li><li>字体统一处理</li><li>高质量图片替换</li><li>智能背景处理</li></ul></li><li><strong>技术细节</strong>: <ul><li>基于 IOU 算法筛选相关文本框</li><li>统一字体为&quot;微软雅黑&quot;</li><li>从 JSON 中提取高清图片并替换</li><li>基于边缘多样性和颜色差异的智能背景处理</li></ul></li></ul><h2 id="🔍-核心算法" tabindex="-1">🔍 核心算法 <a class="header-anchor" href="#🔍-核心算法" aria-label="Permalink to “🔍 核心算法”">​</a></h2><h3 id="iou-交并比-算法" tabindex="-1">IOU（交并比）算法 <a class="header-anchor" href="#iou-交并比-算法" aria-label="Permalink to “IOU（交并比）算法”">​</a></h3><p><strong>应用场景</strong>: MinerU 优化中的文本框筛选</p><p><strong>原理</strong>:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> compute_iou</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(boxA, boxB):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 计算两个矩形的交集面积</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xA </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(boxA[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], boxB[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    yA </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(boxA[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], boxB[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xB </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(boxA[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], boxB[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    yB </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(boxA[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], boxB[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    interWidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xB </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xA)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    interHeight </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, yB </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> yA)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    interArea </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> interWidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> interHeight</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    boxAArea </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (boxA[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> boxA[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (boxA[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> boxA[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    boxBArea </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (boxB[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> boxB[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (boxB[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> boxB[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    iou </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> interArea </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> float</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(boxAArea </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> boxBArea </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> interArea)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iou</span></span></code></pre></div><p><strong>使用方式</strong>:</p><ul><li>计算 MinerU 识别的文本框与 PDF 内容块的 IOU</li><li>保留 IOU 值较高的文本框（相关性强）</li><li>删除 IOU 值较低的文本框（可能是无关元素）</li></ul><h3 id="图像修复算法" tabindex="-1">图像修复算法 <a class="header-anchor" href="#图像修复算法" aria-label="Permalink to “图像修复算法”">​</a></h3><p><strong>应用场景</strong>: 去除 NotebookLM 水印</p><p><strong>算法列表</strong>:</p><ol><li><strong>智能平滑</strong>：综合效果最佳，适合大多数场景</li><li><strong>边缘均值填充</strong>：取周围像素平均色填充</li><li><strong>极速纯色填充</strong>：直接填充单一背景色</li><li><strong>逐层内缩修补</strong>：由外向内逐层修补</li><li><strong>渐变过渡插值</strong>：计算平滑的曲面过渡</li><li><strong>双调和光影修补</strong>：保持光影连续性</li></ol><h3 id="边缘多样性检测算法" tabindex="-1">边缘多样性检测算法 <a class="header-anchor" href="#边缘多样性检测算法" aria-label="Permalink to “边缘多样性检测算法”">​</a></h3><p><strong>应用场景</strong>: MinerU 优化中的智能背景处理</p><p><strong>原理</strong>:</p><ul><li>计算文本块边缘的颜色多样性</li><li>计算文本块四个角的颜色差异</li><li>根据计算结果判断是纯色区域还是复杂背景</li><li>纯色区域填充平均颜色，复杂背景保留原背景</li></ul><h2 id="🚀-性能优化" tabindex="-1">🚀 性能优化 <a class="header-anchor" href="#🚀-性能优化" aria-label="Permalink to “🚀 性能优化”">​</a></h2><h3 id="并行处理" tabindex="-1">并行处理 <a class="header-anchor" href="#并行处理" aria-label="Permalink to “并行处理”">​</a></h3><p>程序支持并行处理多个 PDF 页面，显著提升转换速度：</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> concurrent.futures </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ThreadPoolExecutor</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> process_pages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pages):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ThreadPoolExecutor(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">max_workers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> executor:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(executor.map(process_single_page, pages))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results</span></span></code></pre></div><h3 id="缓存机制" tabindex="-1">缓存机制 <a class="header-anchor" href="#缓存机制" aria-label="Permalink to “缓存机制”">​</a></h3><p>为了避免重复计算，程序实现了缓存机制：</p><ul><li>PDF 转 PNG 结果缓存</li><li>水印检测结果缓存</li><li>MinerU JSON 解析结果缓存</li><li>图片下载缓存</li></ul><h3 id="内存管理" tabindex="-1">内存管理 <a class="header-anchor" href="#内存管理" aria-label="Permalink to “内存管理”">​</a></h3><p>对于大型 PDF 文件，程序采用分块处理策略：</p><ul><li>每次只处理一定数量的页面</li><li>及时释放不再使用的资源</li><li>避免内存溢出</li></ul><h3 id="依赖优化" tabindex="-1">依赖优化 <a class="header-anchor" href="#依赖优化" aria-label="Permalink to “依赖优化”">​</a></h3><p>在 v0.6.0 版本中，程序进行了深度依赖优化：</p><ul><li><strong>移除 Scikit-learn</strong>：将原有的 DBSCAN 边缘多样性检测替换为高性能的 Numpy 原生实现</li><li><strong>移除 OpenCV</strong>：全屏图像显示引擎全面迁移至 Tkinter</li><li><strong>体积效益</strong>：编译后的 .exe 或二进制文件大小大大减小，冷启动速度与内存占用大幅优化</li></ul><h2 id="⚙️-关键技术参数" tabindex="-1">⚙️ 关键技术参数 <a class="header-anchor" href="#⚙️-关键技术参数" aria-label="Permalink to “⚙️ 关键技术参数”">​</a></h2><table tabindex="0"><thead><tr><th>参数</th><th>默认值</th><th>作用</th><th>影响</th></tr></thead><tbody><tr><td><strong>button_offset</strong></td><td>0</td><td>智能圈选按钮偏移量</td><td>决定程序能否准确定位按钮</td></tr><tr><td><strong>dpi</strong></td><td>200</td><td>PDF 转 PNG 分辨率</td><td>影响图片质量和转换速度</td></tr><tr><td><strong>display_scale</strong></td><td>0.8</td><td>图片显示比例</td><td>影响圈选效果和转换成功率</td></tr><tr><td><strong>delay</strong></td><td>2 秒</td><td>操作延迟</td><td>影响操作稳定性和转换速度</td></tr><tr><td><strong>timeout</strong></td><td>60 秒</td><td>超时时间</td><td>影响转换稳定性和效率</td></tr></tbody></table><h2 id="📊-性能基准" tabindex="-1">📊 性能基准 <a class="header-anchor" href="#📊-性能基准" aria-label="Permalink to “📊 性能基准”">​</a></h2><h3 id="转换速度" tabindex="-1">转换速度 <a class="header-anchor" href="#转换速度" aria-label="Permalink to “转换速度”">​</a></h3><table tabindex="0"><thead><tr><th>PDF 页数</th><th>基础转换</th><th>MinerU 优化</th></tr></thead><tbody><tr><td>10 页</td><td>~2 分钟</td><td>~3 分钟</td></tr><tr><td>20 页</td><td>~4 分钟</td><td>~6 分钟</td></tr><tr><td>50 页</td><td>~10 分钟</td><td>~15 分钟</td></tr></tbody></table><h3 id="资源占用" tabindex="-1">资源占用 <a class="header-anchor" href="#资源占用" aria-label="Permalink to “资源占用”">​</a></h3><table tabindex="0"><thead><tr><th>资源类型</th><th>基础转换</th><th>MinerU 优化</th></tr></thead><tbody><tr><td>CPU</td><td>30-50%</td><td>40-60%</td></tr><tr><td>内存</td><td>500MB</td><td>1GB</td></tr><tr><td>磁盘</td><td>100MB</td><td>500MB</td></tr></tbody></table><h2 id="🔗-相关文档" tabindex="-1">🔗 相关文档 <a class="header-anchor" href="#🔗-相关文档" aria-label="Permalink to “🔗 相关文档”">​</a></h2><ul><li><a href="./mineru.html">MinerU 优化</a>：详细了解 MinerU 深度优化的技术实现</li><li><a href="./features.html">功能介绍</a>：了解工具的核心功能</li><li><a href="./quickstart.html">快速开始</a>：快速上手使用指南</li></ul>`,63)])])}const g=i(t,[["render",h]]);export{E as __pageData,g as default};
